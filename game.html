<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Snake Game - totanui.github.io</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background-color: #1a1a2e;
            color: #e0e0e0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            overflow: hidden;
            touch-action: none;
            -webkit-user-select: none;
            user-select: none;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            max-width: 400px;
            padding: 10px 5px;
        }

        .score {
            font-size: 1.2rem;
            font-weight: bold;
            color: #00d2ff;
        }

        .best-score {
            font-size: 1rem;
            color: #888;
        }

        #gameCanvas {
            border: 2px solid #16213e;
            border-radius: 8px;
            background-color: #0f3460;
            display: block;
            max-width: 100%;
        }

        .overlay {
            position: absolute;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 16px;
            background: rgba(26, 26, 46, 0.92);
            border-radius: 16px;
            padding: 32px 28px;
            z-index: 10;
            text-align: center;
        }

        .overlay h2 {
            font-size: 1.6rem;
            color: #00d2ff;
            margin-bottom: 4px;
        }

        .overlay p {
            font-size: 1rem;
            color: #ccc;
            line-height: 1.5;
        }

        .overlay .final-score {
            font-size: 1.3rem;
            color: #e94560;
            font-weight: bold;
        }

        .btn {
            padding: 14px 36px;
            font-size: 1.1rem;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            background: linear-gradient(135deg, #00d2ff, #3a7bd5);
            color: #fff;
            transition: transform 0.1s, opacity 0.2s;
        }

        .btn:active {
            transform: scale(0.95);
            opacity: 0.9;
        }

        .controls-hint {
            margin-top: 12px;
            font-size: 0.85rem;
            color: #666;
        }

        .back-link {
            position: fixed;
            top: 12px;
            left: 12px;
            color: #00d2ff;
            text-decoration: none;
            font-size: 0.9rem;
            z-index: 20;
        }

        .back-link:hover {
            text-decoration: underline;
        }

        .dpad {
            display: none;
            margin-top: 16px;
            width: 160px;
            height: 160px;
            position: relative;
        }

        .dpad-btn {
            position: absolute;
            width: 52px;
            height: 52px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.4rem;
            color: #ccc;
            cursor: pointer;
            -webkit-tap-highlight-color: transparent;
        }

        .dpad-btn:active {
            background: rgba(0, 210, 255, 0.3);
            border-color: #00d2ff;
        }

        .dpad-up    { top: 0;    left: 54px; }
        .dpad-down  { bottom: 0; left: 54px; }
        .dpad-left  { top: 54px; left: 0;    }
        .dpad-right { top: 54px; right: 0;   }

        @media (pointer: coarse) {
            .dpad {
                display: block;
            }
        }

        @media (max-height: 600px) {
            .header { padding: 4px 5px; }
            .dpad { width: 130px; height: 130px; margin-top: 8px; }
            .dpad-btn { width: 42px; height: 42px; font-size: 1.1rem; }
            .dpad-up    { left: 44px; }
            .dpad-down  { left: 44px; }
            .dpad-left  { top: 44px; }
            .dpad-right { top: 44px; }
        }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">‚Üê Home</a>

    <div class="header">
        <span class="score">Score: <span id="score">0</span></span>
        <span class="best-score">Best: <span id="bestScore">0</span></span>
    </div>

    <canvas id="gameCanvas" width="400" height="400"></canvas>

    <div class="dpad" id="dpad">
        <button class="dpad-btn dpad-up"    data-dir="up">‚ñ≤</button>
        <button class="dpad-btn dpad-down"  data-dir="down">‚ñº</button>
        <button class="dpad-btn dpad-left"  data-dir="left">‚óÄ</button>
        <button class="dpad-btn dpad-right" data-dir="right">‚ñ∫</button>
    </div>

    <div class="overlay" id="startOverlay">
        <h2>üêç Snake</h2>
        <p>Swipe or use the D-pad to move.<br>Eat food to grow. Don't hit the walls or yourself!</p>
        <button class="btn" id="startBtn">Play</button>
        <p class="controls-hint">Desktop: Arrow keys or WASD</p>
    </div>

    <div class="overlay" id="gameOverOverlay" style="display:none;">
        <h2>Game Over</h2>
        <p class="final-score">Score: <span id="finalScore">0</span></p>
        <button class="btn" id="restartBtn">Play Again</button>
    </div>

    <script>
    (function () {
        "use strict";

        var canvas = document.getElementById("gameCanvas");
        var ctx = canvas.getContext("2d");
        var scoreEl = document.getElementById("score");
        var bestScoreEl = document.getElementById("bestScore");
        var finalScoreEl = document.getElementById("finalScore");
        var startOverlay = document.getElementById("startOverlay");
        var gameOverOverlay = document.getElementById("gameOverOverlay");
        var startBtn = document.getElementById("startBtn");
        var restartBtn = document.getElementById("restartBtn");
        var dpad = document.getElementById("dpad");

        var GRID = 20;
        var TILE;
        var COLS;
        var ROWS;
        var BASE_INTERVAL = 150;
        var SPEED_INCREMENT = 2;
        var MIN_INTERVAL = 60;

        var snake, direction, nextDirection, food, score, bestScore, gameInterval, running;

        function resize() {
            var maxSize = Math.min(window.innerWidth - 20, window.innerHeight - 200, 400);
            maxSize = Math.max(maxSize, 200);
            TILE = Math.floor(maxSize / GRID);
            var size = TILE * GRID;
            canvas.width = size;
            canvas.height = size;
            COLS = GRID;
            ROWS = GRID;
            if (running) draw();
        }

        function loadBest() {
            try {
                bestScore = parseInt(localStorage.getItem("snakeBest"), 10) || 0;
            } catch (e) {
                bestScore = 0;
            }
            bestScoreEl.textContent = bestScore;
        }

        function saveBest() {
            if (score > bestScore) {
                bestScore = score;
                bestScoreEl.textContent = bestScore;
                try { localStorage.setItem("snakeBest", bestScore); } catch (e) { /* ignore */ }
            }
        }

        function init() {
            snake = [
                { x: Math.floor(GRID / 2), y: Math.floor(GRID / 2) }
            ];
            direction = { x: 1, y: 0 };
            nextDirection = { x: 1, y: 0 };
            score = 0;
            scoreEl.textContent = score;
            placeFood();
        }

        function placeFood() {
            var occupied;
            do {
                food = {
                    x: Math.floor(Math.random() * COLS),
                    y: Math.floor(Math.random() * ROWS)
                };
                occupied = snake.some(function (s) { return s.x === food.x && s.y === food.y; });
            } while (occupied);
        }

        function currentInterval() {
            return Math.max(MIN_INTERVAL, BASE_INTERVAL - score * SPEED_INCREMENT);
        }

        function update() {
            direction = { x: nextDirection.x, y: nextDirection.y };

            var head = {
                x: snake[0].x + direction.x,
                y: snake[0].y + direction.y
            };

            if (head.x < 0 || head.x >= COLS || head.y < 0 || head.y >= ROWS) {
                return gameOver();
            }

            for (var i = 0; i < snake.length; i++) {
                if (snake[i].x === head.x && snake[i].y === head.y) {
                    return gameOver();
                }
            }

            snake.unshift(head);

            if (head.x === food.x && head.y === food.y) {
                score++;
                scoreEl.textContent = score;
                placeFood();
                clearInterval(gameInterval);
                gameInterval = setInterval(update, currentInterval());
            } else {
                snake.pop();
            }

            draw();
        }

        function draw() {
            ctx.fillStyle = "#0f3460";
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            for (var r = 0; r < ROWS; r++) {
                for (var c = 0; c < COLS; c++) {
                    if ((r + c) % 2 === 0) {
                        ctx.fillStyle = "rgba(255,255,255,0.02)";
                        ctx.fillRect(c * TILE, r * TILE, TILE, TILE);
                    }
                }
            }

            ctx.fillStyle = "#e94560";
            ctx.shadowColor = "#e94560";
            ctx.shadowBlur = 10;
            ctx.beginPath();
            ctx.arc(food.x * TILE + TILE / 2, food.y * TILE + TILE / 2, TILE / 2 - 2, 0, Math.PI * 2);
            ctx.fill();
            ctx.shadowBlur = 0;

            for (var j = 0; j < snake.length; j++) {
                var segment = snake[j];
                var isHead = j === 0;
                ctx.fillStyle = isHead ? "#00d2ff" : "#00b4d8";
                ctx.shadowColor = isHead ? "#00d2ff" : "transparent";
                ctx.shadowBlur = isHead ? 8 : 0;
                var padding = 1;
                ctx.fillRect(
                    segment.x * TILE + padding,
                    segment.y * TILE + padding,
                    TILE - padding * 2,
                    TILE - padding * 2
                );
            }
            ctx.shadowBlur = 0;
        }

        function gameOver() {
            running = false;
            clearInterval(gameInterval);
            saveBest();
            finalScoreEl.textContent = score;
            gameOverOverlay.style.display = "flex";
        }

        function startGame() {
            startOverlay.style.display = "none";
            gameOverOverlay.style.display = "none";
            init();
            draw();
            running = true;
            gameInterval = setInterval(update, currentInterval());
        }

        function setDirection(dx, dy) {
            if (!running) return;
            if (direction.x === -dx && direction.y === -dy) return;
            if (dx !== 0 && direction.x === dx) return;
            if (dy !== 0 && direction.y === dy) return;
            nextDirection = { x: dx, y: dy };
        }

        document.addEventListener("keydown", function (e) {
            switch (e.key) {
                case "ArrowUp":    case "w": case "W": e.preventDefault(); setDirection(0, -1); break;
                case "ArrowDown":  case "s": case "S": e.preventDefault(); setDirection(0, 1);  break;
                case "ArrowLeft":  case "a": case "A": e.preventDefault(); setDirection(-1, 0); break;
                case "ArrowRight": case "d": case "D": e.preventDefault(); setDirection(1, 0);  break;
            }
        });

        var touchStartX = 0;
        var touchStartY = 0;
        var SWIPE_THRESHOLD = 30;

        canvas.addEventListener("touchstart", function (e) {
            e.preventDefault();
            var touch = e.touches[0];
            touchStartX = touch.clientX;
            touchStartY = touch.clientY;
        }, { passive: false });

        canvas.addEventListener("touchmove", function (e) {
            e.preventDefault();
        }, { passive: false });

        canvas.addEventListener("touchend", function (e) {
            e.preventDefault();
            if (!e.changedTouches.length) return;
            var touch = e.changedTouches[0];
            var dx = touch.clientX - touchStartX;
            var dy = touch.clientY - touchStartY;
            if (Math.abs(dx) < SWIPE_THRESHOLD && Math.abs(dy) < SWIPE_THRESHOLD) return;
            if (Math.abs(dx) > Math.abs(dy)) {
                setDirection(dx > 0 ? 1 : -1, 0);
            } else {
                setDirection(0, dy > 0 ? 1 : -1);
            }
        }, { passive: false });

        dpad.addEventListener("click", function (e) {
            var btn = e.target.closest("[data-dir]");
            if (!btn) return;
            switch (btn.getAttribute("data-dir")) {
                case "up":    setDirection(0, -1); break;
                case "down":  setDirection(0, 1);  break;
                case "left":  setDirection(-1, 0); break;
                case "right": setDirection(1, 0);  break;
            }
        });

        startBtn.addEventListener("click", startGame);
        restartBtn.addEventListener("click", startGame);

        window.addEventListener("resize", resize);
        loadBest();
        resize();
        init();
        draw();
    })();
    </script>
</body>
</html>
